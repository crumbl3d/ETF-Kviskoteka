<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>ETF Kviskoteka: Reset lozinke</title>
    </h:head>
    <h:body>
        <h:outputStylesheet library="css" name="style.css" />
        <div class="outer">
            <div class="inner">
                <p:panel id="panel" style="width: 400px" header="ETF Kviskoteka: Reset lozinke">
                    <h:panelGrid style="width: 100%" columns="1">
                        <h:form rendered="#{resetLozinkeBean.korak == 0}">
                            <p:messages globalOnly="true" showSummary="false" showDetail="true" showIcon="false" />
                            <p:commandButton class="submit-button" value="Nazad na prijavu" action="/public/prijava" />
                        </h:form>
                        <h:form rendered="#{resetLozinkeBean.korak == 1}">
                            <h:outputLabel for="@next"><b>Korisničko ime</b></h:outputLabel>
                            <p:inputText class="input-text"
                                         placeholder="Unesite korisničko ime"
                                         value="#{resetLozinkeBean.korisnickoIme}"
                                         required="true"
                                         requiredMessage="Korisničko ime je obavezno!">
                                <p:ajax update="@next" event="keyup" />
                            </p:inputText>
                            <p:message for="@previous" display="text" />

                            <h:outputLabel for="@next"><b>JMBG</b></h:outputLabel>
                            <p:inputText class="input-text"
                                         placeholder="Unesite JMBG"
                                         value="#{resetLozinkeBean.jmbg}"
                                         maxlength="13"
                                         required="true"
                                         requiredMessage="JMBG je obavezan!"
                                         validatorMessage="JMBG mora sadržati tačno 13 cifara!">
                                <f:validateRegex pattern="^\d{13}$" />
                                <p:ajax update="@next" event="keyup" />
                            </p:inputText>
                            <p:message for="@previous" display="text" />

                            <p:commandButton class="submit-button"
                                             value="Nastavi"
                                             update="panel"
                                             action="#{resetLozinkeBean.prviKorak()}">
                                <f:ajax />
                            </p:commandButton>
                            
                            <p:messages globalOnly="true" closable="true" showSummary="false" showDetail="true" showIcon="false" />
                        </h:form>
                        <h:form rendered="#{resetLozinkeBean.korak == 2}">
                            <h:outputLabel for="@next"><b>Tajno pitanje</b></h:outputLabel>
                            <br />
                            <span style="margin: 10px 0">#{resetLozinkeBean.trazeni.tajnoPitanje}</span>
                            <br />
                            <h:outputLabel for="@next"><b>Odgovor</b></h:outputLabel>
                            <p:inputText class="input-text"
                                         placeholder="Unesite odgovor"
                                         value="#{resetLozinkeBean.odgovor}"
                                         required="true"
                                         requiredMessage="Odgovor je obavezan!">
                                <p:ajax update="@next" event="keyup" />
                            </p:inputText>
                            <p:message for="@previous" display="text" />

                            <p:commandButton class="submit-button"
                                             value="Nastavi"
                                             update="panel"
                                             action="#{resetLozinkeBean.drugiKorak()}">
                                <f:ajax />
                            </p:commandButton>
                            
                            <p:messages globalOnly="true" closable="true" showSummary="false" showDetail="true" showIcon="false" />
                        </h:form>
                        <h:form rendered="#{resetLozinkeBean.korak == 3}">
                            <h:outputLabel for="@next"><b>Nova lozinka</b></h:outputLabel>
                            <p:password class="input-text"
                                        placeholder="Unesite novu lozinku" 
                                        value="#{resetLozinkeBean.novaLozinka}"
                                        maxlength="12"
                                        required="true"
                                        requiredMessage="Nova lozinka je obavezna!"
                                        validatorMessage="Lozinka mora imati minimalno 8, a najviše 12 karaktera i to bar 1 veliko slovo, bar 3 mala slova, bar 1 cifru i bar 1 specijalan znak. Pritom početni karakter mora biti malo ili veliko slovo, a maksimalan broj uzastopnih karaktera je 2.">
                                <p:ajax update="@next" event="keyup" />
                                <f:validateRegex pattern="^(?!.*([A-Za-z0-9@$!%*?&amp;])\1{2})(?=.*?[A-Z])(?=(.*?[a-z]){3,})(?=.*?[0-9])(?=.*?[@$!%*?&amp;])(?=)[A-Za-z][A-Za-z\d@$!%*?&amp;]{7,11}$" />
                            </p:password>
                            <p:message for="@previous" display="text" />

                            <h:outputLabel for="@next"><b>Potvrda nove lozinke</b></h:outputLabel>
                            <p:password class="input-text"
                                        placeholder="Ponovo unesite novu lozinku" 
                                        value="#{resetLozinkeBean.potvrdaLozinke}"
                                        maxlength="12"
                                        required="true"
                                        requiredMessage="Nova lozinka se mora potvrditi!"
                                        validatorMessage="Lozinka mora imati minimalno 8, a najviše 12 karaktera i to bar 1 veliko slovo, bar 3 mala slova, bar 1 cifru i bar 1 specijalan znak. Pritom početni karakter mora biti malo ili veliko slovo, a maksimalan broj uzastopnih karaktera je 2.">
                                <p:ajax update="@next" event="keyup" />
                                <f:validateRegex pattern="^(?!.*([A-Za-z0-9@$!%*?&amp;])\1{2})(?=.*?[A-Z])(?=(.*?[a-z]){3,})(?=.*?[0-9])(?=.*?[@$!%*?&amp;])(?=)[A-Za-z][A-Za-z\d@$!%*?&amp;]{7,11}$" />
                            </p:password>
                            <p:message for="@previous" display="text" />

                            <p:commandButton class="submit-button"
                                             value="Promeni lozinku"
                                             update="panel"
                                             action="#{resetLozinkeBean.treciKorak()}">
                                <f:ajax />
                            </p:commandButton>
                            
                            <p:messages globalOnly="true" closable="true" showSummary="false" showDetail="true" showIcon="false" />
                        </h:form>
                        <h:form>
                            <table class="links">
                                <tr>
                                    <td><h:commandLink value="Registracija" action="/public/registracija" /></td>
                                    <td style="text-align: right"><h:commandLink value="Nastavi kao gost" action="/public/gost" /></td>
                                </tr>
                                <tr>
                                    <td><h:commandLink value="Prijava" action="/public/prijava" /></td>
                                    <td style="text-align: right"><h:commandLink value="Promena lozinke" action="/public/promenaLozinke" /></td>
                                </tr>
                            </table>
                        </h:form>
                    </h:panelGrid>
                </p:panel>
            </div>
        </div>
    </h:body>
</html>

