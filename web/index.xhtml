<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>ETF Kviskoteka</title>
    </h:head>
    <h:body>
        <h:outputStylesheet library="css"
                            name="prijava.css" />
        <div class="outer">
            <div class="inner">
                <p:panel class="panel"
                         header="ETF Kviskoteka: #{PrijavaBean.rezim}">
                    <h:panelGrid class="width-100"
                                 columns="1"
                                 rendered="#{PrijavaBean.rezimPrijavljen}">
                        <h:form>
                            <b>Već ste prijavljeni kao #{PrijavaBean.prijavljen.ime} #{PrijavaBean.prijavljen.prezime}!</b>
                            <h:panelGrid class="width-100"
                                         style="margin-top: 10px"
                                         columns="2">
                                <p:commandButton class="width-100"
                                                 value="Odjava"
                                                 action="#{PrijavaBean.odjava()}">
                                    <f:ajax />
                                </p:commandButton>
                                <p:commandButton class="width-100"
                                                 value="Povratak"
                                                 action="#{PrijavaBean.povratak()}">
                                    <f:ajax />
                                </p:commandButton>
                            </h:panelGrid>
                        </h:form>
                    </h:panelGrid>
                    <h:panelGrid class="width-100"
                                 columns="1"
                                 rendered="#{PrijavaBean.rezimPrijava}">
                        <h:form>
                            <h:outputLabel for="korisnickoIme">
                                <b>Korisničko ime</b>
                            </h:outputLabel>
                            <p:inputText id="korisnickoIme" class="input-text"
                                         placeholder="Unesite korisničko ime"
                                         value="#{PrijavaBean.korisnickoIme}"
                                         required="true"
                                         requiredMessage="Korisničko ime je obavezno!">
                                <p:ajax update="msgKorisnickoIme"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgKorisnickoIme"
                                       for="korisnickoIme"
                                       display="text" />

                            <h:outputLabel for="lozinka">
                                <b>Lozinka</b>
                            </h:outputLabel>
                            <p:password id="lozinka" class="input-text"
                                        placeholder="Unesite lozinku" 
                                        value="#{PrijavaBean.lozinka}"
                                        maxlength="12"
                                        required="true"
                                        requiredMessage="Lozinka je obavezna!">
                                <p:ajax update="msgLozinka"
                                        event="keyup" />
                            </p:password>
                            <p:message id="msgLozinka"
                                       for="lozinka"
                                       display="text" />

                            <p:commandButton class="submit-button"
                                             value="Prijava"
                                             action="#{PrijavaBean.prijava()}"
                                             update="msgs">
                                <f:ajax />
                            </p:commandButton>
                            
                            <p:messages id="msgs" closable="true"
                                        showSummary="false"
                                        showDetail="true"
                                        showIcon="false" />
                        </h:form>
                        <h:form>
                            <table class="links">
                                <tr>
                                    <td><h:commandLink value="Registracija" action="#{PrijavaBean.naRegistraciju()}" /></td>
                                    <td style="text-align: right"><h:commandLink value="Nastavi kao gost" action="#{PrijavaBean.prijavaGost()}" /></td>
                                </tr>
                                <tr>
                                    <td><h:commandLink value="Zaboravili ste lozinku?" action="#{PrijavaBean.naZaboravljenaLozinka()}" /></td>
                                    <td style="text-align: right"><h:commandLink value="Promena lozinke" action="#{PrijavaBean.naPromenuLozinke()}" /></td>
                                </tr>
                            </table>
                        </h:form>
                    </h:panelGrid>
                    <h:panelGrid class="width-100"
                                 columns="1"
                                 rendered="#{PrijavaBean.rezimRegistracija}">
                        <h:form>
                            <b>Sve informacije su obavezne!</b>
                            <br />
                            <h:outputLabel for="ime">
                                <b>Ime</b>
                            </h:outputLabel>
                            <p:inputText id="ime" class="input-text"
                                         placeholder="Unesite vaše ime"
                                         value="#{PrijavaBean.ime}"
                                         required="true"
                                         requiredMessage="Ime je obavezno!">
                                <p:ajax update="msgIme"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgIme"
                                       for="ime"
                                       display="text" />

                            <h:outputLabel for="prezime">
                                <b>Prezime</b>
                            </h:outputLabel>
                            <p:inputText id="prezime" class="input-text"
                                         placeholder="Unesite vaše prezime"
                                         value="#{PrijavaBean.prezime}"
                                         required="true"
                                         requiredMessage="Prezime je obavezno!">
                                <p:ajax update="msgPrezime"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgPrezime"
                                       for="prezime"
                                       display="text" />

                            <h:outputLabel for="email">
                                <b>Email</b>
                            </h:outputLabel>
                            <p:inputText id="email" class="input-text"
                                         placeholder="Unesite vaš email"
                                         value="#{PrijavaBean.email}"
                                         required="true"
                                         requiredMessage="Email je obavezan!">
                                <p:ajax update="msgEmail"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgEmail"
                                       for="email"
                                       display="text" />

                            <h:outputLabel for="zanimanje">
                                <b>Zanimanje</b>
                            </h:outputLabel>
                            <p:inputText id="zanimanje" class="input-text"
                                         placeholder="Unesite vaše zanimanje"
                                         value="#{PrijavaBean.zanimanje}"
                                         required="true"
                                         requiredMessage="Zanimanje je obavezno!">
                                <p:ajax update="msgZanimanje"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgZanimanje"
                                       for="zanimanje"
                                       display="text" />

                            <h:outputLabel for="korisnickoIme">
                                <b>Korisničko ime</b>
                            </h:outputLabel>
                            <p:inputText id="korisnickoIme" class="input-text"
                                         placeholder="Unesite korisničko ime"
                                         value="#{PrijavaBean.korisnickoIme}"
                                         required="true"
                                         requiredMessage="Korisničko ime je obavezno!">
                                <p:ajax update="msgKorisnickoIme"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgKorisnickoIme"
                                       for="korisnickoIme"
                                       display="text" />

                            <h:outputLabel for="lozinka">
                                <b>Lozinka</b>
                            </h:outputLabel>
                            <p:password id="lozinka" class="input-text"
                                        placeholder="Unesite lozinku" 
                                        value="#{PrijavaBean.novaLozinka}"
                                        maxlength="12"
                                        required="true"
                                        requiredMessage="Lozinka je obavezna!"
                                        validatorMessage="Lozinka mora imati minimalno 8, a najviše 12 karaktera i to bar 1 veliko slovo, bar 3 mala slova, bar 1 cifru i bar 1 specijalan znak. Pritom početni karakter mora biti malo ili veliko slovo, a maksimalan broj uzastopnih karaktera je 2.">
                                <p:ajax update="msgLozinka"
                                        event="keyup" />
                                <f:validateRegex pattern="^(?!.*([A-Za-z0-9@$!%*?&amp;])\1{2})(?=.*?[A-Z])(?=(.*?[a-z]){3,})(?=.*?[0-9])(?=.*?[@$!%*?&amp;])(?=)[A-Za-z][A-Za-z\d@$!%*?&amp;]{7,11}$" />
                            </p:password>
                            <p:message id="msgLozinka"
                                       for="lozinka"
                                       display="text" />

                            <h:outputLabel for="lozinka">
                                <b>Potvrda lozinke</b>
                            </h:outputLabel>
                            <p:password id="potvrdaLozinke" class="input-text"
                                        placeholder="Ponovo unesite lozinku" 
                                        value="#{PrijavaBean.novaLozinka2}"
                                        maxlength="12"
                                        required="true"
                                        requiredMessage="Lozinka je obavezna!"
                                        validatorMessage="Lozinka mora imati minimalno 8, a najviše 12 karaktera i to bar 1 veliko slovo, bar 3 mala slova, bar 1 cifru i bar 1 specijalan znak. Pritom početni karakter mora biti malo ili veliko slovo, a maksimalan broj uzastopnih karaktera je 2.">
                                <p:ajax update="msgLozinka"
                                        event="keyup" />
                                <f:validateRegex pattern="^(?!.*([A-Za-z0-9@$!%*?&amp;])\1{2})(?=.*?[A-Z])(?=(.*?[a-z]){3,})(?=.*?[0-9])(?=.*?[@$!%*?&amp;])(?=)[A-Za-z][A-Za-z\d@$!%*?&amp;]{7,11}$" />
                            </p:password>
                            <p:message id="msgPotvrdaLozinke"
                                       for="potvrdaLozinke"
                                       display="text" />

                            <h:outputLabel for="pol">
                                <b>Pol</b>
                            </h:outputLabel>
                            <p:inputText id="pol" class="input-text"
                                         placeholder="Unesite vaš pol"
                                         value="#{PrijavaBean.pol}"
                                         required="true"
                                         requiredMessage="Pol je obavezan!">
                                <p:ajax update="msgPol"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgPol"
                                       for="pol"
                                       display="text" />

                            <h:outputLabel for="jmbg">
                                <b>JMBG</b>
                            </h:outputLabel>
                            <p:inputText id="jmbg" class="input-text"
                                         placeholder="Unesite JMBG" 
                                         value="#{PrijavaBean.jmbg}"
                                         maxlength="13"
                                         required="true"
                                         requiredMessage="JMBG je obavezan!"
                                         validatorMessage="JMBG mora sadržati tačno 13 cifara!">
                                <f:validateRegex pattern="^\d{13}$" />
                                <p:ajax update="msgJmbg"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgJmbg"
                                       for="jmbg"
                                       display="text" />

                            <h:outputLabel for="pitanje">
                                <b>Tajno pitanje</b>
                            </h:outputLabel>
                            <p:inputText id="pitanje" class="input-text"
                                         placeholder="Unesite tajno pitanje"
                                         value="#{PrijavaBean.pitanje}"
                                         required="true"
                                         requiredMessage="Tajno pitanje je obavezno!">
                                <p:ajax update="msgPitanje"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgPitanje"
                                       for="pitanje"
                                       display="text" />

                            <h:outputLabel for="odgovor">
                                <b>Odgovor</b>
                            </h:outputLabel>
                            <p:inputText id="odgovor" class="input-text"
                                         placeholder="Unesite odgovor"
                                         value="#{PrijavaBean.odgovor}"
                                         required="true"
                                         requiredMessage="Odgovor je obavezan!">
                                <p:ajax update="msgOdgovor"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgOdgovor"
                                       for="odgovor"
                                       display="text" />

                            <p:commandButton class="submit-button"
                                             value="Pošalji zahtev"
                                             action="#{PrijavaBean.registracija()}"
                                             update="msgs">
                                <f:ajax />
                            </p:commandButton>
                            
                            <p:messages id="msgs" closable="true"
                                        showSummary="false"
                                        showDetail="true"
                                        showIcon="false" />
                        </h:form>
                        <h:form>
                            <table class="links">
                                <tr>
                                    <td><h:commandLink value="Prijava" action="#{PrijavaBean.naPrijavu()}" /></td>
                                    <td style="text-align: right"><h:commandLink value="Nastavi kao gost" action="#{PrijavaBean.prijavaGost()}" /></td>
                                </tr>
                                <tr>
                                    <td><h:commandLink value="Zaboravili ste lozinku?" action="#{PrijavaBean.naZaboravljenaLozinka()}" /></td>
                                    <td style="text-align: right"><h:commandLink value="Promena lozinke" action="#{PrijavaBean.naPromenuLozinke()}" /></td>
                                </tr>
                            </table>
                        </h:form>
                    </h:panelGrid>
                    <h:panelGrid class="width-100"
                                 columns="1"
                                 rendered="#{PrijavaBean.rezimPromenaLozinke}">
                        <h:form>
                            <h:outputLabel for="korisnickoIme">
                                <b>Korisničko ime</b>
                            </h:outputLabel>
                            <p:inputText id="korisnickoIme" class="input-text"
                                         placeholder="Unesite korisničko ime"
                                         value="#{PrijavaBean.korisnickoIme}"
                                         required="true"
                                         requiredMessage="Korisničko ime je obavezno!">
                                <p:ajax update="msgKorisnickoIme"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgKorisnickoIme"
                                       for="korisnickoIme"
                                       display="text" />

                            <h:outputLabel for="staraLozinka">
                                <b>Stara lozinka</b>
                            </h:outputLabel>
                            <p:password id="staraLozinka" class="input-text"
                                        placeholder="Unesite staru lozinku" 
                                        value="#{PrijavaBean.lozinka}"
                                        maxlength="12"
                                        required="true"
                                        requiredMessage="Stara lozinka je obavezna!">
                                <p:ajax update="msgStaraLozinka"
                                        event="keyup" />
                            </p:password>
                            <p:message id="msgStaraLozinka"
                                       for="staraLozinka"
                                       display="text" />

                            <h:outputLabel for="novaLozinka">
                                <b>Nova lozinka</b>
                            </h:outputLabel>
                            <p:password id="novaLozinka" class="input-text"
                                        placeholder="Unesite novu lozinku" 
                                        value="#{PrijavaBean.novaLozinka}"
                                        maxlength="12"
                                        required="true"
                                        requiredMessage="Nova lozinka je obavezna!">
                                <p:ajax update="msgNovaLozinka"
                                        event="keyup" />
                            </p:password>
                            <p:message id="msgNovaLozinka"
                                       for="novaLozinka"
                                       display="text" />

                            <h:outputLabel for="novaLozinka2">
                                <b>Ponovo nova lozinka</b>
                            </h:outputLabel>
                            <p:password id="novaLozinka2" class="input-text"
                                        placeholder="Ponovo unesite novu lozinku" 
                                        value="#{PrijavaBean.novaLozinka2}"
                                        maxlength="12"
                                        required="true"
                                        requiredMessage="Nova lozinka se mora uneti dva puta!">
                                <p:ajax update="msgNovaLozinka2"
                                        event="keyup" />
                            </p:password>
                            <p:message id="msgNovaLozinka2"
                                       for="novaLozinka2"
                                       display="text" />

                            <p:commandButton class="submit-button"
                                             value="Promeni lozinku"
                                             action="#{PrijavaBean.promenaLozinke()}"
                                             update="msgs">
                                <f:ajax />
                            </p:commandButton>
                            
                            <p:messages id="msgs" closable="true"
                                        showSummary="false"
                                        showDetail="true"
                                        showIcon="false" />
                        </h:form>
                        <h:form>
                            <table class="links">
                                <tr>
                                    <td><h:commandLink value="Registracija" action="#{PrijavaBean.naRegistraciju()}" /></td>
                                    <td style="text-align: right"><h:commandLink value="Nastavi kao gost" action="#{PrijavaBean.prijavaGost()}" /></td>
                                </tr>
                                <tr>
                                    <td><h:commandLink value="Zaboravili ste lozinku?" action="#{PrijavaBean.naZaboravljenaLozinka()}" /></td>
                                    <td style="text-align: right"><h:commandLink value="Prijava" action="#{PrijavaBean.naPrijavu()}" /></td>
                                </tr>
                            </table>
                        </h:form>
                    </h:panelGrid>
                    <h:panelGrid class="width-100"
                                 columns="1"
                                 rendered="#{PrijavaBean.rezimZaboravljenaLozinka}">
                        <h:form rendered="#{PrijavaBean.rezimZaboravljenaLozinka1}">
                            <h:outputLabel for="korisnickoIme">
                                <b>Korisničko ime</b>
                            </h:outputLabel>
                            <p:inputText id="korisnickoIme" class="input-text"
                                         placeholder="Unesite korisničko ime"
                                         value="#{PrijavaBean.korisnickoIme}"
                                         required="true"
                                         requiredMessage="Korisničko ime je obavezno!">
                                <p:ajax update="msgKorisnickoIme"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgKorisnickoIme"
                                       for="korisnickoIme"
                                       display="text" />

                            <h:outputLabel for="jmbg">
                                <b>JMBG</b>
                            </h:outputLabel>
                            <p:inputText id="jmbg" class="input-text"
                                         placeholder="Unesite JMBG" 
                                         value="#{PrijavaBean.jmbg}"
                                         maxlength="13"
                                         required="true"
                                         requiredMessage="JMBG je obavezan!"
                                         validatorMessage="JMBG mora sadržati tačno 13 cifara!">
                                <f:validateRegex pattern="^\d{13}$" />
                                <p:ajax update="msgJmbg"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgJmbg"
                                       for="jmbg"
                                       display="text" />

                            <p:commandButton class="submit-button"
                                             value="Nastavi"
                                             action="#{PrijavaBean.zaboravljenaLozinka(1)}"
                                             update="msgs">
                                <f:ajax />
                            </p:commandButton>
                            
                            <p:messages id="msgs" closable="true"
                                        showSummary="false"
                                        showDetail="true"
                                        showIcon="false" />
                        </h:form>
                        <h:form rendered="#{PrijavaBean.rezimZaboravljenaLozinka2}">
                            <h:outputLabel for="pitanje">
                                <b>Tajno pitanje</b>
                            </h:outputLabel>
                            <br />
                            <span id="pitanje" style="margin-bottom: 10px">#{PrijavaBean.pitanje}</span>
                            <br />
                            <h:outputLabel for="odgovor">
                                <b>Odgovor</b>
                            </h:outputLabel>
                            <p:inputText id="odgovor" class="input-text"
                                         placeholder="Unesite odgovor"
                                         value="#{PrijavaBean.odgovor}"
                                         required="true"
                                         requiredMessage="Odgovor je obavezan!">
                                <p:ajax update="msgOdgovor"
                                        event="keyup" />
                            </p:inputText>
                            <p:message id="msgOdgovor"
                                       for="odgovor"
                                       display="text" />

                            <p:commandButton class="submit-button"
                                             value="Proveri"
                                             action="#{PrijavaBean.zaboravljenaLozinka(2)}"
                                             update="msgs">
                                <f:ajax />
                            </p:commandButton>
                            
                            <p:messages id="msgs" closable="true"
                                        showSummary="false"
                                        showDetail="true"
                                        showIcon="false" />
                        </h:form>
                        <h:form rendered="#{PrijavaBean.rezimZaboravljenaLozinka3}">
                            <h:outputLabel for="novaLozinka">
                                <b>Nova lozinka</b>
                            </h:outputLabel>
                            <p:password id="novaLozinka" class="input-text"
                                        placeholder="Unesite novu lozinku" 
                                        value="#{PrijavaBean.novaLozinka}"
                                        maxlength="12"
                                        required="true"
                                        requiredMessage="Nova lozinka je obavezna!">
                                <p:ajax update="msgNovaLozinka"
                                        event="keyup" />
                            </p:password>
                            <p:message id="msgNovaLozinka"
                                       for="novaLozinka"
                                       display="text" />

                            <h:outputLabel for="novaLozinka2">
                                <b>Ponovo nova lozinka</b>
                            </h:outputLabel>
                            <p:password id="novaLozinka2" class="input-text"
                                        placeholder="Ponovo unesite novu lozinku" 
                                        value="#{PrijavaBean.novaLozinka2}"
                                        maxlength="12"
                                        required="true"
                                        requiredMessage="Nova lozinka se mora uneti dva puta!">
                                <p:ajax update="msgNovaLozinka2"
                                        event="keyup" />
                            </p:password>
                            <p:message id="msgNovaLozinka2"
                                       for="novaLozinka2"
                                       display="text" />

                            <p:commandButton class="submit-button"
                                             value="Promeni lozinku"
                                             action="#{PrijavaBean.zaboravljenaLozinka(3)}"
                                             update="msgs">
                                <f:ajax />
                            </p:commandButton>
                            
                            <p:messages id="msgs" closable="true"
                                        showSummary="false"
                                        showDetail="true"
                                        showIcon="false" />
                        </h:form>
                        <h:form>
                            <table class="links">
                                <tr>
                                    <td><h:commandLink value="Registracija" action="#{PrijavaBean.naRegistraciju()}" /></td>
                                    <td style="text-align: right"><h:commandLink value="Nastavi kao gost" action="#{PrijavaBean.prijavaGost()}" /></td>
                                </tr>
                                <tr>
                                    <td><h:commandLink value="Prijava" action="#{PrijavaBean.naPrijavu()}" /></td>
                                    <td style="text-align: right"><h:commandLink value="Promena lozinke" action="#{PrijavaBean.naPromenuLozinke()}" /></td>
                                </tr>
                            </table>
                        </h:form>
                    </h:panelGrid>
                </p:panel>
            </div>
        </div>
    </h:body>
</html>